
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>pick a random element from a long array - Icemelon</title>
	<meta name="author" content="icemelon">

	
	<meta name="description" content="Suppose you have an array of n elemnets and you have to pick an element randomly. It is easy that you just pick each element with probability 1/n. &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="" rel="alternate" title="Icemelon" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Icemelon</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/blog/me">Me</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/blog/me">Me</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:ice-melon.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/icemelon_" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/ice-melon" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:ice-melon.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Pick a Random Element From a Long Array</h2>
	<div class="entry-content"><p>Suppose you have an array of n elemnets and you have to pick an element randomly. It is easy that you just pick each element with probability 1/n.</p>

<p>While if you don&rsquo;t know the size of the array, you receive the element one at a time. How to pick the element? In theory you could wait for all elements to come and compute the probility. But the stream may be too large to be stored in memory, which makes it infeasible. We want an algorithm that we do not have to store the elements and look at the elements twice.</p>

<p>Here comes the solution:</p>

<pre><code>1.Choose the first element with probability 1
2.Replace the first element with the second element, with probability 1/2
3.Replace the current element with the third element, with probability 1/3
4.Continue doing this until the stream ends.
</code></pre>

<p>Let&rsquo;s prove the correctness by induction:</p>

<p>Suppose that after seeing n-1 elements, each of the first n-1 elements is chosen with equal probability.<br/>
When you see the nth element, it is chosen with probability 1/n, and each of the other elements is chosen
with probability [1/(n-1)] * [(n-1) / n] = 1/n. Therefore all elements are chosen with equal probability.</p>

<p>The algorithm takes O(1) space and O(n) time, which is quite simple and beautiful.
For more information, see <a href="http://en.wikipedia.org/wiki/Reservoir_sampling">Reservior sample</a> on Wikipedia.</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-24T22:53:00+08:00" pubdate data-updated="true">Aug 24<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/english/'>English</a>, <a class='category' href='/blog/categories/algorithm/'>algorithm</a>


</div>
	
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
	
<!-- JiaThis Button BEGIN -->
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?uid=1374762077227410&move=0" charset="utf-8"></script>
<!-- JiaThis Button END -->

</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    icemelon

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'icemelon';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ice-melon.github.io/blog/2013/08/24/pick-a-random-element-from-a-long-array/';
        var disqus_url = 'http://ice-melon.github.io/blog/2013/08/24/pick-a-random-element-from-a-long-array/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>